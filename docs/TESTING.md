# 双向AI对话同步功能测试指南

## 🚀 快速测试步骤

### 1. 启动服务
```bash
npm start
```

### 2. 打开Web界面
访问：`http://localhost:3459`

### 3. 连接Cursor
1. 在Cursor中打开AI聊天面板
2. 按F12打开开发者工具
3. 切换到Console标签
4. 复制Web界面"工作空间"标签页中的注入脚本
5. 粘贴到Console并执行
6. 看到"✅ WebSocket连接成功"表示连接成功

### 4. 测试双向同步

#### 测试1：Cursor → Web 同步
1. 在Cursor中输入一条消息并发送
2. 检查Web界面"AI助手"标签页是否显示该消息
3. 消息应该有"🔄 来自 Cursor"标识

#### 测试2：Web → Cursor 同步
1. 在Web界面"AI助手"标签页输入消息
2. 点击发送按钮或按Ctrl+Enter
3. 检查Cursor中是否自动输入了该消息
4. Web界面应显示"📤 发送到 Cursor"状态

## 🔍 功能验证

### 连接状态检查
- [ ] 顶部状态栏显示"🟢 服务器已连接"
- [ ] AI助手界面显示"✅ 已连接"
- [ ] Console中显示WebSocket连接日志

### 消息同步检查
- [ ] Cursor中的用户消息同步到Web
- [ ] Cursor中的AI回复同步到Web
- [ ] Web发送的消息出现在Cursor中
- [ ] 同步消息有正确的标识和样式

### 界面功能检查
- [ ] 搜索功能正常工作
- [ ] 清空对话功能正常
- [ ] 字符计数显示正确
- [ ] 消息时间戳显示正确

## 🐛 故障排除

### 连接问题
- 检查端口3459和3460是否被占用
- 确认Cursor中正确执行了注入脚本
- 查看浏览器Console是否有错误信息

### 同步问题
- 检查Console日志确认消息发送接收
- 确认Cursor的输入框可以正常使用
- 尝试刷新页面重新连接

### 发送失败
- 检查Cursor中是否有弹窗或其他阻挡
- 确认输入框处于活动状态
- 查看Console中的错误信息

## 📝 测试日志

记录测试结果：

```
日期：__________
测试人：__________

✅ 服务启动正常
✅ Web界面加载正常  
✅ Cursor连接成功
✅ Cursor→Web同步正常
✅ Web→Cursor同步正常
✅ 消息格式化正常
✅ 搜索功能正常
✅ 状态指示正常

问题记录：
- 无

建议改进：
- 无
```

## 🎯 高级测试

### 压力测试
1. 快速发送多条消息
2. 发送长文本消息
3. 发送包含代码的消息
4. 同时在多个标签页打开Web界面

### 兼容性测试
1. 测试不同浏览器（Chrome、Firefox、Edge）
2. 测试移动端浏览器
3. 测试不同Cursor版本

### 网络测试
1. 测试网络延迟情况
2. 测试网络中断重连
3. 测试防火墙环境 